C:\Users\Think>docker-machine ls
NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER    ERRORS
bigdata   -        virtualbox   Running   tcp://192.168.99.101:2376           v1.12.2
default   -        virtualbox   Stopped                                       Unknown

C:\Users\Think>FOR /f "tokens=*" %i IN ('docker-machine env --shell cmd bigdata') DO %i

C:\Users\Think>SET DOCKER_TLS_VERIFY=1

C:\Users\Think>SET DOCKER_HOST=tcp://192.168.99.101:2376

C:\Users\Think>SET DOCKER_CERT_PATH=C:\Users\Think\.docker\machine\machines\bigdata

C:\Users\Think>SET DOCKER_MACHINE_NAME=bigdata

C:\Users\Think>REM Run this command to configure your shell:

C:\Users\Think>REM      @FOR /f "tokens=*" %i IN ('docker-machine env --shell cmd bigdata') DO @%i

C:\Users\Think>docker run -d -p 3000:3000 unclebarney/chit-chat
54a9e0147df2ab2e5b863b104b16391dc21a59bcede1b046ca146791601a4c1d

C:\Users\Think>docker images
REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE
cassandra               3.7                 25427f353269        2 weeks ago         382.4 MB
confluent/zookeeper     latest              4a1778ad1528        4 months ago        584.5 MB
confluent/kafka         latest              2b9ba35e1775        4 months ago        584.5 MB
unclebarney/chit-chat   latest              639e46d7a14a        8 months ago        31.86 MB

C:\Users\Think>docker ps
CONTAINER ID        IMAGE                   COMMAND             CREATED             STATUS              PORTS                    NAMES
54a9e0147df2        unclebarney/chit-chat   "node index.js"     9 minutes ago       Up 7 seconds        0.0.0.0:3000->3000/tcp   distracted_brahmagupta


C:\Users\Think>docker run -d -p 2181:2181 -p 2888:2888 -p 3888:3888 --name zookeeper confluent/zookeeper
551d89333475ae2678864a3aaeb02f7616b328aed551e75e6a85c0b1091ea71f

C:\Users\Think>docker run -d -p 9092:9092 -e KAFKA_ADVERTISED_HOST_NAME=192.168.99.101 -e KAFKA_ADVERTISED_PORT=9092 --name kafka --link zookeeper:zookeeper confluent/kafka
b37f2a5609b09d21cbac114b0a30e24ee077c604d2cf9867bbf1d018e8378f14

C:\Users\Think>docker run -d -p 7199:7199 -p 9042:9042 -p 9160:9160 -p 7001:7001 --name cassandra cassandra:3.7
bd5ef4f55c3112237b1cd74715433472e7be3ce4123b4248a4f4fbb587b70d05


C:\Users\Think>docker ps
CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS                                                                                                      NAMES
bd5ef4f55c31        cassandra:3.7           "/docker-entrypoint.s"   19 minutes ago      Up 2 seconds        0.0.0.0:7001->7001/tcp, 0.0.0.0:7199->7199/tcp, 0.0.0.0:9042->9042/tcp, 7000/tcp, 0.0.0.0:9160->9160/tcp   cassandra
b37f2a5609b0        confluent/kafka         "/usr/local/bin/kafka"   20 minutes ago      Up 49 seconds       0.0.0.0:9092->9092/tcp                                                                                     kafka
551d89333475        confluent/zookeeper     "/usr/local/bin/zk-do"   21 minutes ago      Up About a minute   0.0.0.0:2181->2181/tcp, 0.0.0.0:2888->2888/tcp, 0.0.0.0:3888->3888/tcp                                     zookeeper
54a9e0147df2        unclebarney/chit-chat   "node index.js"          40 minutes ago      Up 20 minutes       0.0.0.0:3000->3000/tcp                                                                                     distracted_brahmagupta

C:\Users\Think>D:\BigData\kafka_2.11-0.10.0.1\bin\windows\kafka-topics.bat --create --zookeeper 192.168.99.101 --replication-factor 1 --partitions 1 --topic bigdata
Created topic "bigdata".

D:\BigData\kafka_2.11-0.10.0.1\bin>.\windows\kafka-topics.bat --list --zookeeper 192.168.99.101
Bigdata


D:\BigData\zookeeper-3.4.9\bin>zkCli.cmd -server 192.168.99.101:2181
Connecting to 192.168.99.101:2181
2016-10-19 00:54:31,593 [myid:] - INFO  [main:Environment@100] - Client environment:zookeeper.version=3.4.9-1757313, built on 08/23/2016 06:50 GMT
2016-10-19 00:54:31,597 [myid:] - INFO  [main:Environment@100] - Client environment:host.name=192.168.99.1
2016-10-19 00:54:31,598 [myid:] - INFO  [main:Environment@100] - Client environment:java.version=1.8.0_40
2016-10-19 00:54:31,601 [myid:] - INFO  [main:Environment@100] - Client environment:java.vendor=Oracle Corporation
2016-10-19 00:54:31,602 [myid:] - INFO  [main:Environment@100] - Client environment:java.home=D:\Java\jdk1.8.0_40\jre
2016-10-19 00:54:31,605 [myid:] - INFO  [main:Environment@100] - Client environment:java.class.path=D:\BigData\zookeeper-3.4.9\bin\..\build\classes;D:\BigData\zookeeper-3.4.9\bin\..\build\lib\*;D:\BigData\zookeeper-3.4.9\bin\..\zookeeper-3.4.9.jar;D:\BigData\zookeeper-3.4.9\bin\..\lib\jline-0.9.94.jar;D:\BigData\zookeeper-3.4.9\bin\..\lib\log4j-1.2.16.jar;D:\BigData\zookeeper-3.4.9\bin\..\lib\netty-3.10.5.Final.jar;D:\BigData\zookeeper-3.4.9\bin\..\lib\slf4j-api-1.6.1.jar;D:\BigData\zookeeper-3.4.9\bin\..\lib\slf4j-log4j12-1.6.1.jar;D:\BigData\zookeeper-3.4.9\bin\..\conf
2016-10-19 00:54:31,609 [myid:] - INFO  [main:Environment@100] - Client environment:java.library.path=D:\Java\jdk1.8.0_40\bin;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;;D:\scala\bin;D:\scala\jre\bin;D:\Java\jdk1.8.0_40\bin;D:\Java\jdk1.8.0_40\jre\bin;C:\ProgramData\Oracle\Java\javapath;C:\Program Files (x86)\Intel\iCLS Client\;C:\Program Files\Intel\iCLS Client\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Intel\Intel(R) Management Engine Components\DAL;C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\DAL;C:\Program Files\Intel\Intel(R) Management Engine Components\IPT;C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\IPT;C:\Program Files\Lenovo\Fingerprint Manager Pro\;C:\Program Files (x86)\Windows Kits\8.1\Windows Performance Toolkit\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\Program Files (x86)\Microsoft SDKs\TypeScript\1.0\;C:\Program Files\Microsoft SQL Server\120\Tools\Binn\;D:\Program Files (x86)\Autodesk\Backburner\;C:\Program Files (x86)\Common Files\Autodesk Shared\;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files\Microsoft SQL Server\100\DTS\Binn\;D:\Program Files\IDM Computer Solutions\UltraEdit;C:\Program Files\Git\cmd;D:\Program Files\MATLAB\R2014b\runtime\win64;D:\Program Files\MATLAB\R2014b\bin;D:\Program Files\MATLAB\R2014b\polyspace\bin;C:\Program Files (x86)\Skype\Phone\;C:\Program Files (x86)\scala\bin\;D:\Program Files (x86)\sbt\\bin;C:\Program Files (x86)\sbt\\bin;D:\scala\bin;C:\Users\Think\Anaconda2;C:\Users\Think\Anaconda2\Scripts;C:\Users\Think\Anaconda2\Library\bin;D:\Java\jdk1.8.0_40\bin;D:\Java\jdk1.8.0_40\jre\bin;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files (x86)\OpenVPN\bin;C:\TDM-GCC-64\bin;C:\Program Files\Docker Toolbox;C:\Program Files (x86)\MacType;.
2016-10-19 00:54:31,617 [myid:] - INFO  [main:Environment@100] - Client environment:java.io.tmpdir=C:\Users\Think\AppData\Local\Temp\
2016-10-19 00:54:31,624 [myid:] - INFO  [main:Environment@100] - Client environment:java.compiler=<NA>
2016-10-19 00:54:31,626 [myid:] - INFO  [main:Environment@100] - Client environment:os.name=Windows 8.1
2016-10-19 00:54:31,629 [myid:] - INFO  [main:Environment@100] - Client environment:os.arch=amd64
2016-10-19 00:54:31,631 [myid:] - INFO  [main:Environment@100] - Client environment:os.version=6.3
2016-10-19 00:54:31,634 [myid:] - INFO  [main:Environment@100] - Client environment:user.name=Think
2016-10-19 00:54:31,636 [myid:] - INFO  [main:Environment@100] - Client environment:user.home=C:\Users\Think
2016-10-19 00:54:31,639 [myid:] - INFO  [main:Environment@100] - Client environment:user.dir=D:\BigData\zookeeper-3.4.9\bin
2016-10-19 00:54:31,643 [myid:] - INFO  [main:ZooKeeper@438] - Initiating client connection, connectString=192.168.99.101:2181 sessionTimeout=30000 watcher=org.apache.zookeeper.ZooKeeperMain$MyWatcher@4b85612c
Welcome to ZooKeeper!
2016-10-19 00:54:31,740 [myid:] - INFO  [main-SendThread(192.168.99.101:2181):ClientCnxn$SendThread@1032] - Opening socket connection to server 192.168.99.101/192.168.99.101:2181. Will not attempt to authenticate using SASL (unknown error)
2016-10-19 00:54:31,744 [myid:] - INFO  [main-SendThread(192.168.99.101:2181):ClientCnxn$SendThread@876] - Socket connection established to 192.168.99.101/192.168.99.101:2181, initiating session
JLine support is enabled
2016-10-19 00:54:31,758 [myid:] - INFO  [main-SendThread(192.168.99.101:2181):ClientCnxn$SendThread@1299] - Session establishment complete on server 192.168.99.101/192.168.99.101:2181, sessionid = 0x157d75b7af70004, negotiated timeout = 30000

WATCHER::

WatchedEvent state:SyncConnected type:None path:null
[zk: 192.168.99.101:2181(CONNECTED) 0] ls /
[controller_epoch, controller, brokers, zookeeper, admin, isr_change_notification, consumers, config]
[zk: 192.168.99.101:2181(CONNECTED) 1] quit
Quitting...
2016-10-19 01:07:06,963 [myid:] - INFO  [main:ZooKeeper@684] - Session: 0x157d75b7af70005 closed


进入到zookeeper客户端，使用ls命令可以看到各个znode节点.

在两个cmd上分别运行
kafka-console-producer.bat --broker-list 192.168.99.101:9092 --topic bigdata
kafka-console-consumer.bat --zookeeper 192.168.99.101:2181 --topic bigdata

在producer中发送的消息可以被consumer接收到，
如在consumer后加上--from-beginning 参数则可以接收到broker中的全部指令。


D:\BigData\kafka_2.11-0.10.0.1\bin\windows>docker exec -it kafka bash
confluent@b37f2a5609b0:/$ ls
bin   dev  home  lib64  mnt  proc  run   srv  tmp  var
boot  etc  lib   media  opt  root  sbin  sys  usr
confluent@b37f2a5609b0:/$ cd /var/l
lib/   local/ lock/  log/
confluent@b37f2a5609b0:/$ cd /var/lib/kafka/
confluent@b37f2a5609b0:/var/lib/kafka$ ls
bigdata-0                  recovery-point-offset-checkpoint
cleaner-offset-checkpoint  replication-offset-checkpoint
meta.properties

[zk: 192.168.99.100:2181(CONNECTED) 0] ls /
[controller_epoch, controller, brokers, zookeeper, admin, isr_change_notification, consumers, config]
[zk: 192.168.99.100:2181(CONNECTED) 1] ls /zookeeper
[quota]
[zk: 192.168.99.100:2181(CONNECTED) 2] get /zookeeper/quota

cZxid = 0x0
ctime = Thu Jan 01 08:00:00 CST 1970
mZxid = 0x0
mtime = Thu Jan 01 08:00:00 CST 1970
pZxid = 0x0
cversion = 0
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 0
numChildren = 0
[zk: 192.168.99.100:2181(CONNECTED) 3] create /workers "zbx"
Created /workers
[zk: 192.168.99.100:2181(CONNECTED) 4] ls /
[controller_epoch, controller, brokers, zookeeper, admin, isr_change_notification, consumers, config, workers]
[zk: 192.168.99.100:2181(CONNECTED) 5] ls /workers
[]
[zk: 192.168.99.100:2181(CONNECTED) 6] get /workers
zbx
cZxid = 0x18a
ctime = Thu Oct 20 10:17:47 CST 2016
mZxid = 0x18a
mtime = Thu Oct 20 10:17:47 CST 2016
pZxid = 0x18a
cversion = 0
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 3
numChildren = 0
[zk: 192.168.99.100:2181(CONNECTED) 7] del

delquota   delete
[zk: 192.168.99.100:2181(CONNECTED) 7] delete /workers
[zk: 192.168.99.100:2181(CONNECTED) 8] ls /workers
Node does not exist: /workers
[zk: 192.168.99.100:2181(CONNECTED) 9] get /wokers
Node does not exist: /wokers
[zk: 192.168.99.100:2181(CONNECTED) 10] get /workers
Node does not exist: /workers
[zk: 192.168.99.100:2181(CONNECTED) 11] create -e /workers "zzzbbbxxx"
Created /workers
[zk: 192.168.99.100:2181(CONNECTED) 12] ls /
[controller_epoch, controller, brokers, zookeeper, admin, isr_change_notification, consumers, config, workers]
[zk: 192.168.99.100:2181(CONNECTED) 13] ls /workers
[]
[zk: 192.168.99.100:2181(CONNECTED) 14] get /workers
zzzbbbxxx
cZxid = 0x18c
ctime = Thu Oct 20 10:19:11 CST 2016
mZxid = 0x18c
mtime = Thu Oct 20 10:19:11 CST 2016
pZxid = 0x18c
cversion = 0
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x157dcfab33a001e
dataLength = 9
numChildren = 0

